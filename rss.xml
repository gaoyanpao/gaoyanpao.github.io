<?xml version="1.0" encoding="utf-8"?>






<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>dapao</title>
        <link>https://gaoyanpao.github.io/</link>
        <description></description>
        <generator>Hugo 0.68.3 https://gohugo.io/</generator>
        
            <language>zh-CN</language>
        
        
            <managingEditor>gaoyanpao@gmail.com (dapao)</managingEditor>
        
        
            <webMaster>gaoyanpao@gmail.com (dapao)</webMaster>
        
        
            <copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright>
        
        <lastBuildDate>Sun, 23 Aug 2020 20:41:14 +0800</lastBuildDate>
        
            <atom:link rel="self" type="application/rss+xml" href="https://gaoyanpao.github.io/rss.xml" />
        
        
            <item>
                <title>Charle抓取https</title>
                <link>https://gaoyanpao.github.io/posts/charles_https/</link>
                <guid isPermaLink="true">https://gaoyanpao.github.io/posts/charles_https/</guid>
                <pubDate>Sun, 23 Aug 2020 16:56:26 +0800</pubDate>
                
                    <author>gaoyanpao@gmail.com (dapao)</author>
                
                <copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright>
                
                    <description><![CDATA[<h2 id="charles设置">charles设置</h2>
<ol>
<li>
<p>Proxy-&gt;Proxy Settings...
<img src="/img/charles_proxy_settings.png" alt="proxy settings"></p>
</li>
<li>
<p>Proxy-&gt;SSL Proxy Settings...</p>
</li>
</ol>
<p>添加需要监听的地址和端口
<img src="/img/charles_ssl_proxy_settings.png" alt="ssl proxy settings"></p>
<h2 id="ssl证书设置">ssl证书设置</h2>
<h5 id="chrelse-根证书">Chrelse 根证书</h5>
<ol>
<li>
<p>Help-&gt;SSL Proxing-&gt;Install Charles Root Certificate</p>
<p>此时会自动打开系统的证书管理, 将安装好的charles根证书设置为信任
<img src="/img/charles_ssl_cert.png" alt="ssl cert"></p>
</li>
</ol>
<h5 id="安卓端证书">安卓端证书</h5>
<ol>
<li>连接上charles代理后, 打开chls.pro/ssl下载证书并安装: wlan-&gt;高级设置-&gt;安装证书</li>
<li>Android 6.0 (API level 23)以后，APP默认只信任系统自带的CA证书，对于用户导入的不再信任, 解决方案:
<ol>
<li>
<p>参考<a href="https://developer.android.google.cn/training/articles/security-config">官方文档</a>:</p>
</li>
<li>
<p>将证书安装为系统证书, 需要root权限</p>
<p>证书的命名规则: &lt;Certificate_Hash&gt;.<Number>, 文件名为证书文件的hash值, 后缀为一个数字, 主要用于标记区别hash值相同的文件</p>
<p>证书hash计算: <code>openssl x509 -subject_hash_old -in &lt;Certificate_File&gt;</code></p>
<p>将证书改名后拷贝到, 系统证书目录：<code>/system/etc/security/cacerts/</code></p>
</li>
</ol>
</li>
</ol>
]]></description>
                
                
                
                
                
                    
                        
                    
                        
                    
                
            </item>
        
            <item>
                <title>Hyperledger Fabric学习1: 启动第一个fabric网络</title>
                <link>https://gaoyanpao.github.io/posts/fabric/learn1/</link>
                <guid isPermaLink="true">https://gaoyanpao.github.io/posts/fabric/learn1/</guid>
                <pubDate>Wed, 20 May 2020 09:44:28 +0800</pubDate>
                
                    <author>gaoyanpao@gmail.com (dapao)</author>
                
                <copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright>
                
                    <description><![CDATA[<ol>
<li>
<p>二进制文件下载</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Shell" data-lang="Shell">curl -sSL https://bit.ly/2ysbOFE <span class="p">|</span> bash -s
</code></pre></td></tr></table>
</div>
</div><p>可以指定版本</p>
<pre><code>curl -sSL https://bit.ly/2ysbOFE | bash -s -- &lt;fabric_version&gt; &lt;fabric-ca_version&gt; &lt;thirdparty_version&gt;
curl -sSL https://bit.ly/2ysbOFE | bash -s -- 2.0.1 1.4.6 0.4.18
</code></pre><p>下载完成后将fabric-sample/bin加入环境变量path</p>
</li>
<li>
<p>启动并创建第一个区块
创建区块</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">./byfn.sh generate
</code></pre></td></tr></table>
</div>
</div><p>启动/关闭fabric网络</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">./byfn.sh up
./byfn.sh down
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
]]></description>
                
                
                
                
                
                    
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://gaoyanpao.github.io/tags/fabric/">fabric</category>
                                
                            
                                
                                
                                
                                    <category domain="https://gaoyanpao.github.io/tags/blockchain/">blockchain</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Python XML转JSON</title>
                <link>https://gaoyanpao.github.io/posts/python_xml_to_json/</link>
                <guid isPermaLink="true">https://gaoyanpao.github.io/posts/python_xml_to_json/</guid>
                <pubDate>Mon, 11 Mar 2019 09:17:52 +0800</pubDate>
                
                    <author>gaoyanpao@gmail.com (dapao)</author>
                
                <copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright>
                
                    <description><![CDATA[<p>sax库实现多层级xml转json</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">xml.sax.handler</span>
<span class="k">class</span> <span class="nc">XmlToJsonHandler</span><span class="p">(</span><span class="n">xml</span><span class="o">.</span><span class="n">sax</span><span class="o">.</span><span class="n">handler</span><span class="o">.</span><span class="n">ContentHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__buffer</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__tree</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__name</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
    <span class="k">def</span> <span class="nf">startElement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attributes</span><span class="p">):</span>
        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_node</span><span class="p">()</span>
        <span class="n">node</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">attributes</span><span class="o">.</span><span class="n">_attrs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__tree</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="k">def</span> <span class="nf">characters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__buffer</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">__name</span><span class="p">:</span> <span class="n">data</span><span class="p">}</span>
    <span class="k">def</span> <span class="nf">endElement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__tree</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_node</span><span class="p">()</span>
        <span class="n">node</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__buffer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__buffer</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">def</span> <span class="nf">getDict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict</span>
    <span class="k">def</span> <span class="nf">get_node</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__tree</span><span class="p">:</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">temp</span>
<span class="k">def</span> <span class="nf">parse_xml_to_json</span><span class="p">(</span><span class="n">xml_string</span><span class="p">):</span>
    <span class="n">handler</span> <span class="o">=</span> <span class="n">XmlToJsonHandler</span><span class="p">()</span>
    <span class="c1"># 删除换行和制表符</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">xml_string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\t</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;  &#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span>
    <span class="c1"># 删除标签之间的空格</span>
    <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;&gt;\s%20&lt;&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">xml</span><span class="o">.</span><span class="n">sax</span><span class="o">.</span><span class="n">parseString</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">handler</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">handler</span><span class="o">.</span><span class="n">getDict</span><span class="p">()</span>
<span class="c1"># 测试</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
    <span class="n">test</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
</span><span class="s2">    &lt;xxxmessage&gt;
</span><span class="s2">        &lt;message&gt;
</span><span class="s2">            &lt;is_test&gt;1&lt;/is_test&gt;
</span><span class="s2">            &lt;channel&gt;12&lt;/channel&gt;
</span><span class="s2">            &lt;channel_uid&gt;123&lt;/channel_uid&gt;
</span><span class="s2">            &lt;game_order&gt;1234&lt;/game_order&gt;
</span><span class="s2">            &lt;order_no&gt;12345&lt;/order_no&gt;
</span><span class="s2">            &lt;pay_time&gt;123456&lt;/pay_time&gt;
</span><span class="s2">            &lt;amount&gt;1234567&lt;/amount&gt;
</span><span class="s2">            &lt;status&gt;1&lt;/status&gt;
</span><span class="s2">            &lt;extras_params main_server=&#34;123&#34;&gt;
</span><span class="s2">                &lt;asd&gt;
</span><span class="s2">                    &lt;asd&gt;123&lt;/asd&gt;
</span><span class="s2">                    &lt;asdd&gt;1233&lt;/asdd&gt;
</span><span class="s2">                &lt;/asd&gt;
</span><span class="s2">            &lt;/extras_params&gt;
</span><span class="s2">        &lt;/message&gt;
</span><span class="s2">    &lt;/xxxmessage&gt;&#34;&#34;&#34;</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">parse_xml_to_json</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div>]]></description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://gaoyanpao.github.io/categories/python/">python</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://gaoyanpao.github.io/tags/xml/">xml</category>
                                
                            
                                
                                
                                
                                    <category domain="https://gaoyanpao.github.io/tags/json/">json</category>
                                
                            
                                
                                
                                
                                    <category domain="https://gaoyanpao.github.io/tags/python/">python</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Google支付校验 Python</title>
                <link>https://gaoyanpao.github.io/posts/googlepay_validate_python/</link>
                <guid isPermaLink="true">https://gaoyanpao.github.io/posts/googlepay_validate_python/</guid>
                <pubDate>Mon, 11 Mar 2019 09:05:15 +0800</pubDate>
                
                    <author>gaoyanpao@gmail.com (dapao)</author>
                
                <copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright>
                
                    <description><![CDATA[<p>开发者服务端公钥校验方式</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">Crypto.Hash</span> <span class="kn">import</span> <span class="n">SHA</span>
<span class="kn">from</span> <span class="nn">Crypto.PublicKey</span> <span class="kn">import</span> <span class="n">RSA</span>
<span class="kn">from</span> <span class="nn">Crypto.Signature</span> <span class="kn">import</span> <span class="n">PKCS1_v1_5</span>
<span class="n">GOOGLE_PUBLIC_KEY</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
<span class="n">chunk_split</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">:</span> <span class="n">n</span> <span class="o">+</span> <span class="n">l</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">l</span><span class="p">)])</span>
<span class="k">def</span> <span class="nf">check_by_public_key</span><span class="p">(</span><span class="n">purchase_data</span><span class="p">,</span> <span class="n">purchase_signature</span><span class="p">):</span>
    <span class="n">public_key</span> <span class="o">=</span> <span class="s2">&#34;-----BEGIN PUBLIC KEY-----</span><span class="si">%s%s%s</span><span class="s2">-----END PUBLIC KEY-----&#34;</span> <span class="o">%</span> \
                 <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">,</span> <span class="n">chunk_split</span><span class="p">(</span><span class="n">GOOGLE_PUBLIC_KEY</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
    <span class="n">rsa_key</span> <span class="o">=</span> <span class="n">RSA</span><span class="o">.</span><span class="n">importKey</span><span class="p">(</span><span class="n">public_key</span><span class="p">)</span>
    <span class="n">verifier</span> <span class="o">=</span> <span class="n">PKCS1_v1_5</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">rsa_key</span><span class="p">)</span>
    <span class="n">digest</span> <span class="o">=</span> <span class="n">SHA</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">purchase_data</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verifier</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">digest</span><span class="p">,</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">purchase_signature</span><span class="p">)):</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span>
</code></pre></td></tr></table>
</div>
</div>]]></description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://gaoyanpao.github.io/categories/python/">python</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://gaoyanpao.github.io/tags/%E6%94%AF%E4%BB%98/">支付</category>
                                
                            
                                
                                
                                
                                    <category domain="https://gaoyanpao.github.io/tags/python/">python</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>AES填充实现</title>
                <link>https://gaoyanpao.github.io/posts/aes_pad/</link>
                <guid isPermaLink="true">https://gaoyanpao.github.io/posts/aes_pad/</guid>
                <pubDate>Thu, 20 Dec 2018 09:44:28 +0800</pubDate>
                
                    <author>gaoyanpao@gmail.com (dapao)</author>
                
                <copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright>
                
                    <description><![CDATA[<p>python:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="c1"># 填充数据</span>
<span class="n">pad</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">,</span> <span class="n">block_size</span><span class="p">:</span> <span class="n">s</span> <span class="o">+</span> <span class="p">(</span><span class="n">block_size</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">%</span> <span class="n">block_size</span><span class="p">)</span> <span class="o">*</span> <span class="nb">chr</span><span class="p">(</span><span class="n">block_size</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">%</span> <span class="n">block_size</span><span class="p">)</span>
<span class="c1"># 还原填充过的数据</span>
<span class="c1"># python2</span>
<span class="n">unpad</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="nb">ord</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])]</span>
<span class="c1"># python3</span>
<span class="n">unpad_bytes</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
</code></pre></td></tr></table>
</div>
</div><p>js:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-JavaScript" data-lang="JavaScript"><span class="kd">function</span> <span class="nx">pcks7padding</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">size</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">offset</span> <span class="o">=</span> <span class="nx">size</span> <span class="o">-</span> <span class="nx">data</span><span class="p">.</span><span class="nx">length</span> <span class="o">%</span> <span class="nx">size</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">data</span> <span class="o">+</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">offset</span><span class="o">+</span><span class="mi">1</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="nx">offset</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>java:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">pkcs7padding</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span><span class="o">,</span> <span class="kt">int</span> <span class="n">blockSize</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">offset</span> <span class="o">=</span> <span class="n">blockSize</span> <span class="o">-</span> <span class="n">bytes</span><span class="o">.</span><span class="na">length</span> <span class="o">%</span> <span class="n">blockSize</span><span class="o">;</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">bytesCopy</span> <span class="o">=</span> <span class="n">bytes</span><span class="o">.</span><span class="na">clone</span><span class="o">();</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">padding</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="n">offset</span><span class="o">];</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">offset</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
            <span class="n">padding</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span><span class="n">offset</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">result</span><span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="n">bytesCopy</span><span class="o">.</span><span class="na">length</span> <span class="o">+</span> <span class="n">offset</span><span class="o">];</span>
        <span class="n">System</span><span class="o">.</span><span class="na">arraycopy</span><span class="o">(</span><span class="n">bytesCopy</span><span class="o">,</span> <span class="n">0</span><span class="o">,</span> <span class="n">result</span><span class="o">,</span> <span class="n">0</span><span class="o">,</span> <span class="n">bytesCopy</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">arraycopy</span><span class="o">(</span><span class="n">padding</span><span class="o">,</span> <span class="n">0</span><span class="o">,</span> <span class="n">result</span><span class="o">,</span> <span class="n">bytesCopy</span><span class="o">.</span><span class="na">length</span><span class="o">,</span> <span class="n">padding</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></description>
                
                
                
                
                
                    
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://gaoyanpao.github.io/tags/crypto/">crypto</category>
                                
                            
                                
                                
                                
                                    <category domain="https://gaoyanpao.github.io/tags/aes/">aes</category>
                                
                            
                        
                    
                
            </item>
        
    </channel>
</rss>
